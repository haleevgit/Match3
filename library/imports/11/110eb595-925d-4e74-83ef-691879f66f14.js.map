{"version":3,"sources":["assets/scripts/Game/Logic/Features/Teleport.js"],"names":["cc","Class","Feature","properties","_firstTeleportPosition","v2","serializable","_secondTeleportPosition","_handleSubscription","isOn","func","systemEvent","initializingEvent","onInitializingEvent","GameEvent","TELEPORTED_BLOCK_CHOSEN","onTeleportBlockChosen","block","_firstBlock","_firstCoord","x","y","emit","CHANGE_BLOCK_ANIMATION","TeleportAnimationsType","None","iI","iJ","Accepted","Choosing","id","_secondCoord","START_TELEPORTATION","featureCoordinate","fieldWidth","fieldHeight"],"mappings":";;;;;;AACA;;AACA;;AACA;;;;AAHA;AAIA;AAEAA,EAAE,CAACC,KAAH,CAAS;EACL,WAASC,mBADJ;EAGLC,UAAU,EAAE;IACRC,sBAAsB,EAAE;MAAE,WAASJ,EAAE,CAACK,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAX;MAAuBC,YAAY,EAAE;IAArC,CADhB;IAERC,uBAAuB,EAAE;MAAE,WAASP,EAAE,CAACK,EAAH,CAAM,CAAN,EAAQ,CAAR,CAAX;MAAuBC,YAAY,EAAE;IAArC;EAFjB,CAHP;EAQL;EAEAE,mBAVK,+BAUeC,IAVf,EAUqB;IACtB,IAAMC,IAAI,GAAGD,IAAI,GAAG,IAAH,GAAU,KAA3B;IAEAT,EAAE,CAACW,WAAH,CAAeD,IAAf,EAAqB,KAAKE,iBAA1B,EAA6C,KAAKC,mBAAlD,EAAuE,IAAvE;IACAb,EAAE,CAACW,WAAH,CAAeD,IAAf,EAAqBI,qBAAA,CAAUC,uBAA/B,EAAwD,KAAKC,qBAA7D,EAAoF,IAApF;EACH,CAfI;EAiBLA,qBAjBK,iCAiBiBC,KAjBjB,EAiBwB;IACzB,IAAI,CAAC,KAAKC,WAAV,EAAuB;MACnB,KAAKA,WAAL,GAAmBD,KAAnB;MACA,KAAKE,WAAL,GAAmBnB,EAAE,CAACK,EAAH,CAAMY,KAAK,CAACG,CAAZ,EAAeH,KAAK,CAACI,CAArB,CAAnB;MACArB,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsD,KAAKnB,sBAA3D,EAAmFoB,kCAAA,CAAuBC,IAA1G;MACAzB,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsDvB,EAAE,CAACK,EAAH,CAAMY,KAAK,CAACS,EAAZ,EAAgBT,KAAK,CAACU,EAAtB,CAAtD,EAAiFH,kCAAA,CAAuBI,QAAxG;;MACA,IAAIX,KAAK,CAACU,EAAN,KAAa,KAAKpB,uBAAL,CAA6Bc,CAA9C,EAAiD;QAC7C,KAAKd,uBAAL,CAA6Ba,CAA7B;MACH;;MACDpB,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsD,KAAKhB,uBAA3D,EAAoFiB,kCAAA,CAAuBK,QAA3G;IACH,CATD,MASO;MACH,IAAIZ,KAAK,CAACa,EAAN,KAAa,KAAKZ,WAAL,CAAiBY,EAAlC,EACI;MACJ,KAAKC,YAAL,GAAoB/B,EAAE,CAACK,EAAH,CAAMY,KAAK,CAACG,CAAZ,EAAeH,KAAK,CAACI,CAArB,CAApB;MACArB,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsD,KAAKhB,uBAA3D,EAAoFiB,kCAAA,CAAuBC,IAA3G;MACAzB,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsDvB,EAAE,CAACK,EAAH,CAAMY,KAAK,CAACS,EAAZ,EAAgBT,KAAK,CAACU,EAAtB,CAAtD,EAAiFH,kCAAA,CAAuBI,QAAxG;MACA5B,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUkB,mBAA9B,EAAmD,KAAKd,WAAxD,EAAqED,KAArE,EAA4E,KAAKE,WAAjF,EAA8F,KAAKY,YAAnG;MACA,KAAKb,WAAL,GAAmB,KAAnB;IACH;EACJ,CApCI;EAsCLL,mBAtCK,+BAsCeoB,iBAtCf,EAsCkCC,UAtClC,EAsC8CC,WAtC9C,EAsC2D;IAC5DnC,EAAE,CAACW,WAAH,CAAeW,IAAf,CAAoBR,qBAAA,CAAUS,sBAA9B,EAAsD,KAAKnB,sBAA3D,EAAmFoB,kCAAA,CAAuBK,QAA1G;EACH;AAxCI,CAAT","sourceRoot":"/","sourcesContent":["//#region classes-helpers\nimport GameEvent from 'GameEvent';\nimport Feature from 'Feature';\nimport TeleportAnimationsType from 'TeleportAnimationsType';\n//#endregion\n \ncc.Class({\n    extends: Feature,\n\n    properties: {\n        _firstTeleportPosition: { default: cc.v2(6,4), serializable: false },\n        _secondTeleportPosition: { default: cc.v2(6,7), serializable: false },\n    },\n  \n    //#region life-cycle callbacks\n\n    _handleSubscription(isOn) {\n        const func = isOn ? 'on' : 'off';\n \n        cc.systemEvent[func](this.initializingEvent, this.onInitializingEvent, this);\n        cc.systemEvent[func](GameEvent.TELEPORTED_BLOCK_CHOSEN, this.onTeleportBlockChosen, this);\n    },\n\n    onTeleportBlockChosen(block) {\n        if (!this._firstBlock) {\n            this._firstBlock = block;\n            this._firstCoord = cc.v2(block.x, block.y);\n            cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, this._firstTeleportPosition, TeleportAnimationsType.None);\n            cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, cc.v2(block.iI, block.iJ), TeleportAnimationsType.Accepted);\n            if (block.iJ === this._secondTeleportPosition.y) {\n                this._secondTeleportPosition.x --;\n            }\n            cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, this._secondTeleportPosition, TeleportAnimationsType.Choosing);\n        } else {\n            if (block.id === this._firstBlock.id)\n                return\n            this._secondCoord = cc.v2(block.x, block.y);\n            cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, this._secondTeleportPosition, TeleportAnimationsType.None);\n            cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, cc.v2(block.iI, block.iJ), TeleportAnimationsType.Accepted);\n            cc.systemEvent.emit(GameEvent.START_TELEPORTATION, this._firstBlock, block, this._firstCoord, this._secondCoord);\n            this._firstBlock = false;\n        }\n    },\n\n    onInitializingEvent(featureCoordinate, fieldWidth, fieldHeight) {\n        cc.systemEvent.emit(GameEvent.CHANGE_BLOCK_ANIMATION, this._firstTeleportPosition, TeleportAnimationsType.Choosing);\n    }\n });\n \n"]}